# ===================================================================
# KIWIPAY LOAN API - CONFIGURACIÓN COMPLETA
# ===================================================================

# ===================================================================
# CONFIGURACIÓN DEL SERVIDOR
# ===================================================================
spring.application.name=kiwipay-loan-api
server.port=8081
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html

# ===================================================================
# SPRING CLOUD COMPATIBILITY
# ===================================================================
spring.cloud.compatibility-verifier.enabled=false

# ===================================================================
# CONFIGURACIÓN DEL BACKEND PRINCIPAL
# ===================================================================
kiwipay.backend.base-url=http://localhost:8080/api/v1
kiwipay.backend.endpoints.create-lead=/leads
kiwipay.backend.endpoints.get-clinics=/clinics
kiwipay.backend.endpoints.get-medical-specialties=/medical-specialties
kiwipay.backend.timeout.connect=30s
kiwipay.backend.timeout.read=60s
kiwipay.backend.retry.max-attempts=3
kiwipay.backend.retry.backoff-delay=1s
kiwipay.backend.retry.max-backoff-delay=10s

# ===================================================================
# CONFIGURACIÓN DE CIRCUIT BREAKER (RESILIENCE4J)
# ===================================================================
resilience4j.circuitbreaker.instances.backend.register-health-indicator=true
resilience4j.circuitbreaker.instances.backend.sliding-window-size=10
resilience4j.circuitbreaker.instances.backend.minimum-number-of-calls=5
resilience4j.circuitbreaker.instances.backend.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.instances.backend.automatic-transition-from-open-to-half-open-enabled=true
resilience4j.circuitbreaker.instances.backend.wait-duration-in-open-state=5s
resilience4j.circuitbreaker.instances.backend.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.backend.event-consumer-buffer-size=10

# ===================================================================
# CONFIGURACIÓN DE RETRY (RESILIENCE4J)
# ===================================================================
resilience4j.retry.instances.backend.max-retry-attempts=3
resilience4j.retry.instances.backend.wait-duration=1000
resilience4j.retry.instances.backend.retry-exceptions=org.springframework.web.reactive.function.client.WebClientResponseException$ServiceUnavailable,org.springframework.web.reactive.function.client.WebClientResponseException$BadGateway,java.io.IOException,java.util.concurrent.TimeoutException

# ===================================================================
# CONFIGURACIÓN DE CORS
# ===================================================================
cors.allowed-origins=http://localhost:3000,http://localhost:3001,http://localhost:4200,http://localhost:5173
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true
cors.max-age=3600

# ===================================================================
# CONFIGURACIÓN DE ACTUATOR
# ===================================================================
management.endpoints.web.exposure.include=health,info,metrics,circuitbreakers
management.endpoints.web.base-path=/actuator
management.endpoint.health.show-details=when-authorized
management.health.circuitbreakers.enabled=true

# ===================================================================
# CONFIGURACIÓN DE LOGGING
# ===================================================================
logging.level.com.kiwipay.kiwipay_loan_api=DEBUG
logging.level.org.springframework.web.reactive.function.client=DEBUG
logging.level.io.github.resilience4j=DEBUG
logging.level.org.springdoc=DEBUG
logging.level.org.springframework.web=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ===================================================================
# CONFIGURACIÓN BÁSICA DE SPRINGDOC - SOLO LO ESENCIAL
# ===================================================================
# Las demás configuraciones las maneja automáticamente SpringDoc
